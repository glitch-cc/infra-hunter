signature:
  id: open-directory-malware
  name: Open Directory - Malware Hosting
  version: 1.0.0
  category: generic
  description: |
    Detects open directories hosting common malware/red team tools.
    Threat actors often use misconfigured web servers as payload staging.
    Searches for directory listings containing tool names.
  logic:
    match: all
    conditions:
      - name: directory_listing_title
        type: http_title
        field: services.http.response.html_title
        operator: regex
        value: "(Index of|Directory Listing)"
        weight: 50
      - name: malware_tools_body
        type: http_body
        field: services.http.response.body
        operator: regex
        value: "(sliver|metasploit|mimikatz|cobalt|beacon|xworm|asyncrat)"
        weight: 70
        note: Common tool names in directory listings
  metadata:
    confidence: medium
    severity: high
    false_positive_rate: medium
    last_verified: '2026-02-08'
  enabled: true
  author: Glitch - OpenClaw
  attribution:
    actors:
      - Various
    confidence: low
    note: Used by many different actors for payload staging
  queries:
    censys: labels=suspicious-open-dir AND (services.http.response.body:sliver OR services.http.response.body:mimikatz OR services.http.response.body:metasploit)
  references:
    - url: https://netlas.io/blog/c2_hunting_cases/
      title: Netlas - Open Directory Hunting
  changelog:
    - version: 1.0.0
      date: '2026-02-08'
      changes: Initial signature
